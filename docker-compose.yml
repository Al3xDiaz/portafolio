version: '3.4'
services:
 frontend:
    container_name: "frontend"
    image: "docker.pkg.github.com/al3xdiaz/portafolio/frontend:latest"
    build:
        context: .
        dockerfile: frontend/dockerfile.test
    #restart: always
    volumes: 
        - "./frontend/src:/code/src"
        - "./frontend/public:/code/public"
    ports: 
        - "80:3000"
    depends_on: 
        - "backend"
 backend:    
    container_name: "backend"
    image: "docker.pkg.github.com/al3xdiaz/portafolio/backend:latest"
    build: 
        context: .
        dockerfile: backend/dockerfile.test
    environment: 
            CON_STR: ${CON_STR}
            MONGO_U: ${MONGO_U}
            MONGO_P: ${MONGO_P}
    restart: always
    volumes: 
        - "./backend/code:/code"
    depends_on: 
        - "db"
 db:
    container_name: db
    image: mongo
    restart: always
    volumes: 
        - ./mongo/data:/data/db
    environment:
        MONGO_INITDB_ROOT_USERNAME: ${MONGO_U}
        MONGO_INITDB_ROOT_PASSWORD: ${MONGO_P}
